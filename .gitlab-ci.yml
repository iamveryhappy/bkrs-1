image: node:4

cache:
  paths:
  - node_modules/

test:
  before_script:
  - apt-get update -qq
  - apt-get install -y dictzip zip
  - node -v
  - npm -v
  - npm install

  script:
  - npm test
  - node lib/fetch
  - npm start --tags=dsl
  - dictzip -k src/b*.dsl
  - mkdir public
  - zip public/bkrs.zip ./src/b*.dsl ./extras/*.bmp
  - zip public/bkrs-min.zip ./src/*.dsl.dz ./extras/*.bmp

  artifacts:
    paths:
    - public
